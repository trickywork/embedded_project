# 电脑端测试说明

## 快速开始

### 1. 编译测试程序

在项目根目录下运行：

```bash
pio run -e native
```

### 2. 运行测试

```bash
pio run -e native -t exec
```

或者直接运行编译后的可执行文件：

```bash
.pio/build/native/program
```

## 测试内容

测试程序会自动运行以下测试：

1. **正常数据测试** - 验证系统不会误报
2. **震颤检测测试** - 生成4Hz信号，验证震颤检测
3. **运动障碍检测测试** - 生成6Hz信号，验证运动障碍检测
4. **冻结步态检测测试** - 模拟先行走后冻结的场景

## 预期输出

测试程序会输出每个测试的检测结果，包括：
- 是否检测到症状（是/否）
- 症状强度（0.0 - 1.0）
- 检测状态标记（✓ 表示正确检测，✗ 表示未检测到）

## 故障排除

### 编译错误

如果遇到编译错误，请检查：

1. **PlatformIO已安装**
   ```bash
   pip install platformio
   ```

2. **native平台支持**
   PlatformIO的native平台需要系统支持C++编译，确保已安装：
   - GCC/G++ (Linux/Mac)
   - MinGW (Windows)

3. **头文件问题**
   如果遇到`mbed.h`相关错误，确保使用了`NATIVE_TEST_MODE`宏定义

### 运行时错误

如果程序运行失败：

1. **检查可执行文件权限**
   ```bash
   chmod +x .pio/build/native/program
   ```

2. **查看详细错误信息**
   运行时会显示具体的错误信息

## 自定义测试

你可以修改`test/main_test.cpp`来创建自己的测试场景：

```cpp
// 生成自定义频率的信号
void generateCustomData(SensorManager& sensor, float frequency, int durationMs) {
    Timer timer;
    timer.start();
    
    while (timer.read_ms() < durationMs) {
        int timeMs = timer.read_ms();
        float accelX = 0.2f * sin(2.0f * M_PI * frequency * timeMs / 1000.0f);
        // ... 设置其他轴的数据
        sensor.setSimulationData(accelX, accelY, accelZ, 0, 0, 0);
        thread_sleep_for(1000 / 52);
    }
}
```

## 下一步

测试通过后，你可以：

1. **连接硬件** - 将代码上传到STM32开发板
2. **调整参数** - 根据实际测试结果调整检测阈值
3. **优化算法** - 改进FFT和步态检测算法

